import{r as f,R as Q}from"./app-d8b8c24c.js";import{s as se,l as A,S as ue,D as K,o as x,u as V,p as ne,R as fe,X as U,y as J,a as ce}from"./use-flags-b545cc66.js";import{I as z,o as $,r as ve,a as me}from"./keyboard-7671dd8e.js";import{h as xe,n as Re}from"./use-owner-82f11557.js";import{s as ge}from"./use-resolve-button-type-9a209279.js";import{F as Oe}from"./use-tree-walker-d23bca06.js";import{u as Ce,a as S,x as Ie}from"./use-tracked-pointer-41ecaf4d.js";import{T as Se,e as Pe}from"./use-controllable-6232ec5f.js";import{c as Te,p as he}from"./hidden-7eeb4a7d.js";import{c as $e,d as Y,C as ye}from"./open-closed-6fc61065.js";import{m as de,n as Ee}from"./dialog-0d0e975e.js";function re(e,l){let[a,o]=f.useState(e),u=se(e);return A(()=>o(u.current),[u,o,...l]),a}var De=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(De||{}),Fe=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(Fe||{}),we=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(we||{}),Me=(e=>(e[e.OpenCombobox=0]="OpenCombobox",e[e.CloseCombobox=1]="CloseCombobox",e[e.GoToOption=2]="GoToOption",e[e.RegisterOption=3]="RegisterOption",e[e.UnregisterOption=4]="UnregisterOption",e[e.RegisterLabel=5]="RegisterLabel",e))(Me||{});function te(e,l=a=>a){let a=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,o=me(l(e.options.slice()),d=>d.dataRef.current.domRef.current),u=a?o.indexOf(a):null;return u===-1&&(u=null),{options:o,activeOptionIndex:u}}let Ae={1(e){var l;return(l=e.dataRef.current)!=null&&l.disabled||e.comboboxState===1?e:{...e,activeOptionIndex:null,comboboxState:1}},0(e){var l;if((l=e.dataRef.current)!=null&&l.disabled||e.comboboxState===0)return e;let a=e.activeOptionIndex;if(e.dataRef.current){let{isSelected:o}=e.dataRef.current,u=e.options.findIndex(d=>o(d.dataRef.current.value));u!==-1&&(a=u)}return{...e,comboboxState:0,activeOptionIndex:a}},2(e,l){var a,o,u,d;if((a=e.dataRef.current)!=null&&a.disabled||(o=e.dataRef.current)!=null&&o.optionsRef.current&&!((u=e.dataRef.current)!=null&&u.optionsPropsRef.current.static)&&e.comboboxState===1)return e;let r=te(e);if(r.activeOptionIndex===null){let R=r.options.findIndex(s=>!s.dataRef.current.disabled);R!==-1&&(r.activeOptionIndex=R)}let g=Ie(l,{resolveItems:()=>r.options,resolveActiveIndex:()=>r.activeOptionIndex,resolveId:R=>R.id,resolveDisabled:R=>R.dataRef.current.disabled});return{...e,...r,activeOptionIndex:g,activationTrigger:(d=l.trigger)!=null?d:1}},3:(e,l)=>{var a,o;let u={id:l.id,dataRef:l.dataRef},d=te(e,g=>[...g,u]);e.activeOptionIndex===null&&(a=e.dataRef.current)!=null&&a.isSelected(l.dataRef.current.value)&&(d.activeOptionIndex=d.options.indexOf(u));let r={...e,...d,activationTrigger:1};return(o=e.dataRef.current)!=null&&o.__demoMode&&e.dataRef.current.value===void 0&&(r.activeOptionIndex=0),r},4:(e,l)=>{let a=te(e,o=>{let u=o.findIndex(d=>d.id===l.id);return u!==-1&&o.splice(u,1),o});return{...e,...a,activationTrigger:1}},5:(e,l)=>({...e,labelId:l.id})},ie=f.createContext(null);ie.displayName="ComboboxActionsContext";function W(e){let l=f.useContext(ie);if(l===null){let a=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(a,W),a}return l}let le=f.createContext(null);le.displayName="ComboboxDataContext";function B(e){let l=f.useContext(le);if(l===null){let a=new Error(`<${e} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(a,B),a}return l}function Le(e,l){return V(l.type,Ae,e,l)}let ke=f.Fragment;function _e(e,l){let{value:a,defaultValue:o,onChange:u,form:d,name:r,by:g=(p,m)=>p===m,disabled:R=!1,__demoMode:s=!1,nullable:O=!1,multiple:I=!1,...t}=e,[n=I?[]:void 0,C]=Se(a,u,o),[v,c]=f.useReducer(Le,{dataRef:f.createRef(),comboboxState:s?0:1,options:[],activeOptionIndex:null,activationTrigger:1,labelId:null}),y=f.useRef(!1),L=f.useRef({static:!1,hold:!1}),q=f.useRef(null),D=f.useRef(null),k=f.useRef(null),_=f.useRef(null),F=x(typeof g=="string"?(p,m)=>{let P=g;return(p==null?void 0:p[P])===(m==null?void 0:m[P])}:g),H=f.useCallback(p=>V(i.mode,{1:()=>n.some(m=>F(m,p)),0:()=>F(n,p)}),[n]),i=f.useMemo(()=>({...v,optionsPropsRef:L,labelRef:q,inputRef:D,buttonRef:k,optionsRef:_,value:n,defaultValue:o,disabled:R,mode:I?1:0,get activeOptionIndex(){if(y.current&&v.activeOptionIndex===null&&v.options.length>0){let p=v.options.findIndex(m=>!m.dataRef.current.disabled);if(p!==-1)return p}return v.activeOptionIndex},compare:F,isSelected:H,nullable:O,__demoMode:s}),[n,o,R,I,O,s,v]),h=f.useRef(i.activeOptionIndex!==null?i.options[i.activeOptionIndex]:null);f.useEffect(()=>{let p=i.activeOptionIndex!==null?i.options[i.activeOptionIndex]:null;h.current!==p&&(h.current=p)}),A(()=>{v.dataRef.current=i},[i]),xe([i.buttonRef,i.inputRef,i.optionsRef],()=>oe.closeCombobox(),i.comboboxState===0);let N=f.useMemo(()=>({open:i.comboboxState===0,disabled:R,activeIndex:i.activeOptionIndex,activeOption:i.activeOptionIndex===null?null:i.options[i.activeOptionIndex].dataRef.current.value,value:n}),[i,R,n]),ee=x(p=>{let m=i.options.find(P=>P.id===p);m&&w(m.dataRef.current.value)}),b=x(()=>{if(i.activeOptionIndex!==null){let{dataRef:p,id:m}=i.options[i.activeOptionIndex];w(p.current.value),oe.goToOption(S.Specific,m)}}),j=x(()=>{c({type:0}),y.current=!0}),E=x(()=>{c({type:1}),y.current=!1}),G=x((p,m,P)=>(y.current=!1,p===S.Specific?c({type:2,focus:S.Specific,id:m,trigger:P}):c({type:2,focus:p,trigger:P}))),T=x((p,m)=>(c({type:3,id:p,dataRef:m}),()=>{var P;((P=h.current)==null?void 0:P.id)===p&&(y.current=!0),c({type:4,id:p})})),M=x(p=>(c({type:5,id:p}),()=>c({type:5,id:null}))),w=x(p=>V(i.mode,{0(){return C==null?void 0:C(p)},1(){let m=i.value.slice(),P=m.findIndex(Z=>F(Z,p));return P===-1?m.push(p):m.splice(P,1),C==null?void 0:C(m)}})),oe=f.useMemo(()=>({onChange:w,registerOption:T,registerLabel:M,goToOption:G,closeCombobox:E,openCombobox:j,selectActiveOption:b,selectOption:ee}),[]),pe=l===null?{}:{ref:l},X=f.useRef(null),be=ne();return f.useEffect(()=>{X.current&&o!==void 0&&be.addEventListener(X.current,"reset",()=>{C==null||C(o)})},[X,C]),Q.createElement(ie.Provider,{value:oe},Q.createElement(le.Provider,{value:i},Q.createElement($e,{value:V(i.comboboxState,{0:Y.Open,1:Y.Closed})},r!=null&&n!=null&&Pe({[r]:n}).map(([p,m],P)=>Q.createElement(Te,{features:he.Hidden,ref:P===0?Z=>{var ae;X.current=(ae=Z==null?void 0:Z.closest("form"))!=null?ae:null}:void 0,...fe({key:p,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:d,name:p,value:m})})),U({ourProps:pe,theirProps:t,slot:N,defaultTag:ke,name:"Combobox"}))))}let Ne="input";function Ve(e,l){var a,o,u,d;let r=z(),{id:g=`headlessui-combobox-input-${r}`,onChange:R,displayValue:s,type:O="text",...I}=e,t=B("Combobox.Input"),n=W("Combobox.Input"),C=J(t.inputRef,l),v=Re(t.inputRef),c=f.useRef(!1),y=ne(),L=x(()=>{n.onChange(null),t.optionsRef.current&&(t.optionsRef.current.scrollTop=0),n.goToOption(S.Nothing)}),q=function(){var b;return typeof s=="function"&&t.value!==void 0?(b=s(t.value))!=null?b:"":typeof t.value=="string"?t.value:""}();de(([b,j],[E,G])=>{if(c.current)return;let T=t.inputRef.current;T&&((G===0&&j===1||b!==E)&&(T.value=b),requestAnimationFrame(()=>{if(c.current||!T||(v==null?void 0:v.activeElement)!==T)return;let{selectionStart:M,selectionEnd:w}=T;Math.abs((w??0)-(M??0))===0&&M===0&&T.setSelectionRange(T.value.length,T.value.length)}))},[q,t.comboboxState,v]),de(([b],[j])=>{if(b===0&&j===1){if(c.current)return;let E=t.inputRef.current;if(!E)return;let G=E.value,{selectionStart:T,selectionEnd:M,selectionDirection:w}=E;E.value="",E.value=G,w!==null?E.setSelectionRange(T,M,w):E.setSelectionRange(T,M)}},[t.comboboxState]);let D=f.useRef(!1),k=x(()=>{D.current=!0}),_=x(()=>{y.nextFrame(()=>{D.current=!1})}),F=x(b=>{switch(c.current=!0,b.key){case $.Enter:if(c.current=!1,t.comboboxState!==0||D.current)return;if(b.preventDefault(),b.stopPropagation(),t.activeOptionIndex===null){n.closeCombobox();return}n.selectActiveOption(),t.mode===0&&n.closeCombobox();break;case $.ArrowDown:return c.current=!1,b.preventDefault(),b.stopPropagation(),V(t.comboboxState,{0:()=>{n.goToOption(S.Next)},1:()=>{n.openCombobox()}});case $.ArrowUp:return c.current=!1,b.preventDefault(),b.stopPropagation(),V(t.comboboxState,{0:()=>{n.goToOption(S.Previous)},1:()=>{n.openCombobox(),y.nextFrame(()=>{t.value||n.goToOption(S.Last)})}});case $.Home:if(b.shiftKey)break;return c.current=!1,b.preventDefault(),b.stopPropagation(),n.goToOption(S.First);case $.PageUp:return c.current=!1,b.preventDefault(),b.stopPropagation(),n.goToOption(S.First);case $.End:if(b.shiftKey)break;return c.current=!1,b.preventDefault(),b.stopPropagation(),n.goToOption(S.Last);case $.PageDown:return c.current=!1,b.preventDefault(),b.stopPropagation(),n.goToOption(S.Last);case $.Escape:return c.current=!1,t.comboboxState!==0?void 0:(b.preventDefault(),t.optionsRef.current&&!t.optionsPropsRef.current.static&&b.stopPropagation(),t.nullable&&t.mode===0&&t.value===null&&L(),n.closeCombobox());case $.Tab:if(c.current=!1,t.comboboxState!==0)return;t.mode===0&&n.selectActiveOption(),n.closeCombobox();break}}),H=x(b=>{R==null||R(b),t.nullable&&t.mode===0&&b.target.value===""&&L(),n.openCombobox()}),i=x(()=>{c.current=!1}),h=re(()=>{if(t.labelId)return[t.labelId].join(" ")},[t.labelId]),N=f.useMemo(()=>({open:t.comboboxState===0,disabled:t.disabled}),[t]),ee={ref:C,id:g,role:"combobox",type:O,"aria-controls":(a=t.optionsRef.current)==null?void 0:a.id,"aria-expanded":t.comboboxState===0,"aria-activedescendant":t.activeOptionIndex===null||(o=t.options[t.activeOptionIndex])==null?void 0:o.id,"aria-labelledby":h,"aria-autocomplete":"list",defaultValue:(d=(u=e.defaultValue)!=null?u:t.defaultValue!==void 0?s==null?void 0:s(t.defaultValue):null)!=null?d:t.defaultValue,disabled:t.disabled,onCompositionStart:k,onCompositionEnd:_,onKeyDown:F,onChange:H,onBlur:i};return U({ourProps:ee,theirProps:I,slot:N,defaultTag:Ne,name:"Combobox.Input"})}let Ke="button";function Ue(e,l){var a;let o=B("Combobox.Button"),u=W("Combobox.Button"),d=J(o.buttonRef,l),r=z(),{id:g=`headlessui-combobox-button-${r}`,...R}=e,s=ne(),O=x(v=>{switch(v.key){case $.ArrowDown:return v.preventDefault(),v.stopPropagation(),o.comboboxState===1&&u.openCombobox(),s.nextFrame(()=>{var c;return(c=o.inputRef.current)==null?void 0:c.focus({preventScroll:!0})});case $.ArrowUp:return v.preventDefault(),v.stopPropagation(),o.comboboxState===1&&(u.openCombobox(),s.nextFrame(()=>{o.value||u.goToOption(S.Last)})),s.nextFrame(()=>{var c;return(c=o.inputRef.current)==null?void 0:c.focus({preventScroll:!0})});case $.Escape:return o.comboboxState!==0?void 0:(v.preventDefault(),o.optionsRef.current&&!o.optionsPropsRef.current.static&&v.stopPropagation(),u.closeCombobox(),s.nextFrame(()=>{var c;return(c=o.inputRef.current)==null?void 0:c.focus({preventScroll:!0})}));default:return}}),I=x(v=>{if(ve(v.currentTarget))return v.preventDefault();o.comboboxState===0?u.closeCombobox():(v.preventDefault(),u.openCombobox()),s.nextFrame(()=>{var c;return(c=o.inputRef.current)==null?void 0:c.focus({preventScroll:!0})})}),t=re(()=>{if(o.labelId)return[o.labelId,g].join(" ")},[o.labelId,g]),n=f.useMemo(()=>({open:o.comboboxState===0,disabled:o.disabled,value:o.value}),[o]),C={ref:d,id:g,type:ge(e,o.buttonRef),tabIndex:-1,"aria-haspopup":"listbox","aria-controls":(a=o.optionsRef.current)==null?void 0:a.id,"aria-expanded":o.comboboxState===0,"aria-labelledby":t,disabled:o.disabled,onClick:I,onKeyDown:O};return U({ourProps:C,theirProps:R,slot:n,defaultTag:Ke,name:"Combobox.Button"})}let Be="label";function qe(e,l){let a=z(),{id:o=`headlessui-combobox-label-${a}`,...u}=e,d=B("Combobox.Label"),r=W("Combobox.Label"),g=J(d.labelRef,l);A(()=>r.registerLabel(o),[o]);let R=x(()=>{var O;return(O=d.inputRef.current)==null?void 0:O.focus({preventScroll:!0})}),s=f.useMemo(()=>({open:d.comboboxState===0,disabled:d.disabled}),[d]);return U({ourProps:{ref:g,id:o,onClick:R},theirProps:u,slot:s,defaultTag:Be,name:"Combobox.Label"})}let He="ul",je=ue.RenderStrategy|ue.Static;function Ge(e,l){let a=z(),{id:o=`headlessui-combobox-options-${a}`,hold:u=!1,...d}=e,r=B("Combobox.Options"),g=J(r.optionsRef,l),R=ye(),s=(()=>R!==null?(R&Y.Open)===Y.Open:r.comboboxState===0)();A(()=>{var n;r.optionsPropsRef.current.static=(n=e.static)!=null?n:!1},[r.optionsPropsRef,e.static]),A(()=>{r.optionsPropsRef.current.hold=u},[r.optionsPropsRef,u]),Oe({container:r.optionsRef.current,enabled:r.comboboxState===0,accept(n){return n.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:n.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(n){n.setAttribute("role","none")}});let O=re(()=>{var n,C;return(C=r.labelId)!=null?C:(n=r.buttonRef.current)==null?void 0:n.id},[r.labelId,r.buttonRef.current]),I=f.useMemo(()=>({open:r.comboboxState===0}),[r]),t={"aria-labelledby":O,role:"listbox","aria-multiselectable":r.mode===1?!0:void 0,id:o,ref:g};return U({ourProps:t,theirProps:d,slot:I,defaultTag:He,features:je,visible:s,name:"Combobox.Options"})}let Je="li";function ze(e,l){var a,o;let u=z(),{id:d=`headlessui-combobox-option-${u}`,disabled:r=!1,value:g,...R}=e,s=B("Combobox.Option"),O=W("Combobox.Option"),I=s.activeOptionIndex!==null?s.options[s.activeOptionIndex].id===d:!1,t=s.isSelected(g),n=f.useRef(null),C=se({disabled:r,value:g,domRef:n,textValue:(o=(a=n.current)==null?void 0:a.textContent)==null?void 0:o.toLowerCase()}),v=J(l,n),c=x(()=>O.selectOption(d));A(()=>O.registerOption(d,C),[C,d]);let y=f.useRef(!s.__demoMode);A(()=>{if(!s.__demoMode)return;let i=ce();return i.requestAnimationFrame(()=>{y.current=!0}),i.dispose},[]),A(()=>{if(s.comboboxState!==0||!I||!y.current||s.activationTrigger===0)return;let i=ce();return i.requestAnimationFrame(()=>{var h,N;(N=(h=n.current)==null?void 0:h.scrollIntoView)==null||N.call(h,{block:"nearest"})}),i.dispose},[n,I,s.comboboxState,s.activationTrigger,s.activeOptionIndex]);let L=x(i=>{if(r)return i.preventDefault();c(),s.mode===0&&O.closeCombobox(),Ee()||requestAnimationFrame(()=>{var h;return(h=s.inputRef.current)==null?void 0:h.focus()})}),q=x(()=>{if(r)return O.goToOption(S.Nothing);O.goToOption(S.Specific,d)}),D=Ce(),k=x(i=>D.update(i)),_=x(i=>{D.wasMoved(i)&&(r||I||O.goToOption(S.Specific,d,0))}),F=x(i=>{D.wasMoved(i)&&(r||I&&(s.optionsPropsRef.current.hold||O.goToOption(S.Nothing)))}),H=f.useMemo(()=>({active:I,selected:t,disabled:r}),[I,t,r]);return U({ourProps:{id:d,ref:v,role:"option",tabIndex:r===!0?void 0:-1,"aria-disabled":r===!0?!0:void 0,"aria-selected":t,disabled:void 0,onClick:L,onFocus:q,onPointerEnter:k,onMouseEnter:k,onPointerMove:_,onMouseMove:_,onPointerLeave:F,onMouseLeave:F},theirProps:R,slot:H,defaultTag:Je,name:"Combobox.Option"})}let We=K(_e),Xe=K(Ue),Ze=K(Ve),Qe=K(qe),Ye=K(Ge),eo=K(ze),bo=Object.assign(We,{Input:Ze,Button:Xe,Label:Qe,Options:Ye,Option:eo});export{bo as q};
